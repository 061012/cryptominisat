AC_INIT(cryptominisat, 3.0.0)

dnl use libtool
AC_PROG_LIBTOOL

dnl we are C++
AC_LANG_CPLUSPLUS
AC_PROG_CXX
AC_LANG(C++)

dnl AC_CONFIG_AUX_DIR([m4-extra])
AC_CONFIG_MACRO_DIR([m4])
AM_INIT_AUTOMAKE

AC_CONFIG_HEADERS(config.h)
AC_CHECK_HEADERS(iostream)

# checks for compiler characteristics
AC_CHECK_SIZEOF([int])
AC_CHECK_SIZEOF([long])
AC_CHECK_SIZEOF([size_t])

# checks for library functions
AC_FUNC_MALLOC
AC_FUNC_MEMCMP

#statistics generation
#AH_TEMPLATE([STATS_NEEDED],[Enable statistics generation code])
#AC_DEFINE([STATS_NEEDED])

#gauss generation needed
#AH_TEMPLATE([USE_GAUSS],[Enable gaussian elimination code])
#AC_DEFINE([USE_GAUSS])

#search for openmp
AC_OPENMP
builtin(include, m4-extra/ax_mpi.m4)
AH_TEMPLATE([USE_MPI],[Enable MPI interface])
AX_MPI([MPI_ENABLE="yes"],
       [AC_MSG_WARN([No suitable C++ MPI implementation found. CryptoMiniSat will not be distributed.])])

AS_IF([test AS_VAR_GET([MPI_ENABLE])],[
    CXX=$MPICXX
#    CC=$MPICC
#    FC=$MPIFC
    AC_DEFINE([USE_MPI])
    AM_CONDITIONAL([MPIBUILD], true)],[
    AM_CONDITIONAL([MPIBUILD], false)]
)
AC_CONFIG_FILES([Makefile Solver/Makefile])
AC_OUTPUT
